<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Computer.css">
    <link rel="icon" type="image/x-icon" href="profile.jpg">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">
    <title>Computer</title>

</head>
<body>
<div class="user-info">
    <span id="display-username"></span>
    <span class="material-icons-sharp" id="user-profile-icon">account_circle</span>
</div>
<div class="header">
    <a href="#default" class="logo"><img src="Logo.png" alt="logo"></a>
    <span class="separator"></span>
    <div class="business">Business</div>

    <div class="header-right">
        <a href="#home">
            <span class="material-icons-sharp">contact_support</span>
            banker
        </a>
        <div class="profile-container">
            <a href="#contact" id="profile-link">
                <span class="material-icons-sharp">account_circle</span>
                Omphile Mohlala
            </a>
            <!-- Popup HTML -->
            <div class="overlay" id="overlay"></div>
            <div class="profile-popup" id="profilePopup">
                <div class="popup-header">omphilestudent@gmail.com</div>
                <div class="profile-item">
                    <span class="material-icons-sharp profile-icon">account_circle</span>
                    <div class="profile-info">
                        <div class="profile-active">ACTIVE PROFILE</div>
                        <a href="Profile-info.html">
                            <div class="profile-Name">Omphile Mohlala</div>
                        </a>
                    </div>
                </div>
                <a href="#" class="switch-profile">
                    <span class="material-icons-sharp" style="font-size: 16px; vertical-align: middle;">swap_horiz</span>
                    Switch to Kodi PTY LTD
                </a>
                <a href="#" class="manage-business">Manage business profile</a>
            </div>
        </div>
        <a href="home page.html" class="sign">Sign Out</a>
    </div>
</div>

<!--Sidebar navigation-->
<nav class="sidebar">
    <!-- sidebar content -->
</nav>

<div class="sidebar">
    <a href="Computer.html" class="active" id="home">
        <span class="material-icons-sharp">home</span>
        Home
    </a>
    <p class="side">BANKING</p>
    <a href="Accounts.html" id="accounts">
        <span class="material-icons-sharp">storage</span>
        Accounts
    </a>
    <div class="dropdown">
        <a href="#" class="dropdown-toggle" id="transacts">
            <span class="material-icons-sharp">swap_horiz</span>
            Transact
            <span class="dropdown-arrow">▶</span>
        </a>
        <div class="dropdown-menu">
            <a href="transact.html" id="payments">Payment</a>
            <a href="#" id="transfer">Transfer</a>
            <a href="#" id="beneficiary">Beneficiary</a>
        </div>
    </div>
    <a href="efiling.html">
        <span class="material-icons-sharp">dynamic_feed</span>
        Cards
    </a>
    <p class="side">MANAGEMENT</p>

    <div class="dropdown">
        <a href="#" class="dropdown-toggle">
            <span class="material-icons-sharp">check_box</span>
            Authorisations
            <span class="dropdown-arrow">▶</span>
        </a>
        <div class="dropdown-menu">
            <a href="#">Transactions</a>
            <a href="#">Beneficiaries</a>
            <a href="#">User Management</a>
            <a href="#">Account & Limits</a>
            <a href="#">Authorisation Levels</a>
            <a href="#">Notification Setup</a>
            <a href="#">Messages</a>
        </div>
    </div>
    <a href="settings.html">
        <span class="material-icons-sharp">groups</span>
        User management
    </a>
    <p class="side">SERVICES</p>
    <a href="settings.html">
        <span class="material-icons-sharp">shopping_cart</span>
        Products & Services
    </a>
    <a href="settings.html">
        <span class="material-icons-sharp">radio_button_unchecked</span>
        SARS eFILLING
    </a>
    <a href="settings.html">
        <span class="material-icons-sharp">chat</span>
        Secure Messages
    </a>
    <a href="settings.html">
        <span class="material-icons-sharp">description</span>
        Documents
    </a>
    <a href="settings.html">
        <span class="material-icons-sharp">settings</span>
        Settings
    </a>
    <a href="Phone.html" class="signout">
        <span class="material-icons-sharp">lock</span>
        We secure your data in line with our Privacy Notice and Terms & Conditions
    </a>
</div>

<div class="search-container">
    <input type="text" id="automation-search" placeholder="What would you like to do? (e.g., 'Pay saved beneficiary')">
    <button id="execute-automation" class="search-button" aria-label="Execute search">
        <span class="material-icons-sharp">search</span> Go
    </button>
    <div id="suggestions-dropdown" class="suggestions-dropdown"></div>
</div>
<br>
<br>
<div style="padding-left:290px">
    <div class="notice">
        <h4>Hello</h4>
        <p>Your last Sign-in was on 13:15, wednesday 21/5/2025.</p>
    </div>
</div>

<!-- Main Content Area -->
<div class="content" id="mainContent">
    <!-- Default content will be loaded here -->
    <div class="account">
        <div class="account-header">
            <h4>Accounts</h4>
            <a href="Accounts.html" class="View">
                View All <span class="material-icons-sharp">chevron_right</span>
            </a>
        </div>
        <div class="box">
            <div class="box1">
                <span class="material-icons-sharp">account_balance</span>
                <span class="separator"></span>
                <a  href="Accounts.html">
                    <div class="account-details">
                        <span class="account-name">1 Account Current</span>
                        <span class="account-balance">R1000</span>
                    </div></a>
                <div class="box2">
                    <span class="material-icons-sharp">storage</span>
                    <span class="separator"></span>
                    <span class="account-name">No other account(s)</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Favorites Section - Placed outside content div -->
<div class="favorites-container">
    <div class="favorites">
        <div class="favorites-header">
            <h4>Favourites</h4>
            <h4 class="edit">Edit</h4>
        </div>
        <div class="favorites-grid">
            <!-- Pay Saved Beneficiary -->
            <div class="favorite-box">
                <span class="material-icons-sharp">person</span>
                <span class="favorite-title">Pay Saved</span>
            </div>

            <!-- Pay Once Off Beneficiary -->
            <div class="favorite-box">
                <span class="material-icons-sharp">person_add</span>
                <span class="favorite-title">Pay Once Off</span>
            </div>

            <!-- Group/Multiple Payments -->
            <div class="favorite-box">
                <span class="material-icons-sharp">groups</span>
                <span class="favorite-title">Multiple</span>
            </div>

            <!-- Transfer Money -->
            <div class="favorite-box" id="transfer-favorite">
                <span class="material-icons-sharp">sync_alt</span>
                <span class="favorite-title">Transfer</span>
            </div>
        </div>
    </div>
</div>

<!--Pending Authorasations-->
<div class="pending">
    <div class="pending-header">
        <h4>Pending Authorisations</h4>
        <a href="all_authorisations.html" class="View">
            View All <span class="material-icons-sharp">chevron_right</span>
        </a>
    </div>
    <div class="pending-box">
        <span class="material-icons-sharp">check_circle</span>
        <span class="pending-title">Authorise</span>
    </div>
</div>

<div class="cash-flow">
    <div class="cash-flow-header">
        <h4>Cash Flow</h4>
    </div>
    <div class="cash-flow-box">
        <span class="material-icons-sharp">account_balance_wallet</span>
        <span class="cash-flow-title">1 Transactional Account</span>
        <div class="select-row">
            <label for="account-select">Select Account</label>
            <select id="account-select" class="account-select">
                <option value="">Please select an account</option>
                <option value="account1">Account 1</option>
                <!-- other options -->
            </select>
            <div class="period-selector">
                <select class="account-select">
                    <option value="account1"> </option>
                    <option value="account1">1 Month</option>
                    <option value="account2">3 Months</option>
                    <option value="account3">6 Months</option>
                </select>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', async () => {
        const token = sessionStorage.getItem('token');

        if (!token) {
            window.location.href = 'Login.html';
            return;
        }

        try {
            const response = await fetch('http://localhost:5000/api/auth/user', {
                headers: {
                    'x-auth-token': token
                }
            });

            const user = await response.json();

            if (!response.ok) {
                throw new Error('Failed to fetch user data');
            }

            // Display user info
            document.getElementById('display-username').textContent = user.name;
            document.querySelectorAll('.profile-Name').forEach(el => el.textContent = user.name);
            document.querySelector('.popup-header').textContent = user.email;

            // Load accounts data
            await loadAccounts();
        } catch (err) {
            console.error(err);
            window.location.href = 'Login.html';
        }
    });

    async function loadAccounts() {
        try {
            const token = sessionStorage.getItem('token');
            const response = await fetch('http://localhost:5000/api/accounts', {
                headers: {
                    'x-auth-token': token
                }
            });

            const accounts = await response.json();

            if (!response.ok) {
                throw new Error('Failed to fetch accounts');
            }

            // Update the accounts display
            const accountsContainer = document.querySelector('.box1 .account-details');
            if (accounts.length > 0) {
                accountsContainer.innerHTML = `
        <span class="account-name">${accounts[0].accountType} Account</span>
        <span class="account-balance">R${accounts[0].balance.toFixed(2)}</span>
      `;
            }
        } catch (err) {
            console.error(err);
        }
    };</script>
<script src="Transfer.js" defer></script>
<script src="Apps.js" defer></script>
<script src="Combined.js" defer></script>
<script src="computer-automation.js" defer></script>
</body>
</html>